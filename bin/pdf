#! /bin/bash

if [ $# -eq 0 ]
  then
    echo "Usage: pdf <path to presentation>"
    exit
fi

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
SLIDES=$(python -c 'import os,sys;print(os.path.realpath(sys.argv[1]))' "$1")
PDF="${SLIDES}/index.pdf"

cd "${DIR}" || (echo "Severe error" && exit)
./setup

docker run --privileged -i -v "${SLIDES}":/slides/ aquilia "/pdf" > "${PDF}"

# If PDF creation failed, it will leave a size 0 index.pdf file
if [[ ! -s ${PDF} ]]; then
  rm -f "${PDF}"
fi
